{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "cgl.risk.snapshot.v1",
  "type": "object",
  "required": [
    "schema_version",
    "snapshot_id",
    "runtime_id",
    "risk_level",
    "signals",
    "window_start",
    "window_end",
    "created_at",
    "telemetry_age_sec"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "pattern": "^v\\d+$"
    },
    "snapshot_id": {
      "type": "string"
    },
    "runtime_id": {
      "type": "string"
    },
    "risk_level": {
      "type": "string",
      "enum": [
        "GREEN",
        "YELLOW",
        "ORANGE",
        "RED",
        "BLACK"
      ]
    },
    "telemetry_age_sec": {
      "type": "number",
      "minimum": 0
    },
    "signals": {
      "type": "object",
      "properties": {
        "C": {
          "type": [
            "number",
            "null"
          ]
        },
        "phase_var": {
          "type": [
            "number",
            "null"
          ]
        },
        "grad_p99": {
          "type": [
            "number",
            "null"
          ]
        },
        "spr": {
          "type": [
            "number",
            "null"
          ]
        },
        "dE_dt": {
          "type": [
            "number",
            "null"
          ]
        },
        "nan_inf_count": {
          "type": [
            "integer",
            "null"
          ]
        }
      },
      "additionalProperties": true
    },
    "window_start": {
      "type": "string",
      "format": "date-time"
    },
    "window_end": {
      "type": "string",
      "format": "date-time"
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    }
  },
  "additionalProperties": false
}